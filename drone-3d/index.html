<!DOCTYPE html>
<html lang="en" dir="ltr">
	<head>
		<title>WebGL Gaussian Splat Viewer</title>
		<meta charset="utf-8" />
		<meta
			name="viewport"
			content="width=device-width, initial-scale=1, minimum-scale=1, maximum-scale=1, user-scalable=no"
		/>
		<meta name="apple-mobile-web-app-capable" content="yes" />
		<meta
			name="apple-mobile-web-app-status-bar-style"
			content="black-translucent"
		/>
		<link rel="stylesheet" href="gs.css" />
	</head>
	<body>
		<script>
			if(location.host.includes('hf.space')) document.body.classList.add('nohf');
		</script>

		<div id="progress"></div>
		<div id="message"></div>
		<div class="scene" id="spinner">
			<div class="cube-wrapper">
				<div class="cube">
					<div class="cube-faces">
						<div class="cube-face bottom"></div>
						<div class="cube-face top"></div>
						<div class="cube-face left"></div>
						<div class="cube-face right"></div>
						<div class="cube-face back"></div>
						<div class="cube-face front"></div>
					</div>
				</div>
			</div>
		</div>
		<canvas id="canvas"></canvas>

		<div id="quality">
			<span id="fps"></span>
		</div>
		<div id="caminfo">
			<span id="camid"></span>
		</div>
		<script src="maings.js"></script>

    
	<div id="root"></div>
	<script type="module" src="/src/main.tsx"></script>
<!-- 
    <script>
      let chatHistory = [];
      function displayUserMessage(message) {
          var userMessageDiv = document.createElement('div');
          userMessageDiv.textContent = 'You: ' + message;
          userMessageDiv.style.color = 'lightblue';
          document.getElementById('chatContent').appendChild(userMessageDiv);
          scrollToBottom();
          
          // Update chat history
          chatHistory.push({
              role: 'user',
              content: message
          });
      }

      function displayBotResponse(message) {
          var botMessageDiv = document.createElement('div');
          botMessageDiv.textContent = 'Bot: ' + message;
          botMessageDiv.style.color = 'lightgreen';
          document.getElementById('chatContent').appendChild(botMessageDiv);
          scrollToBottom();
          
          // Update chat history
          chatHistory.push({
              role: 'system', // or 'assistant' depending on the API's expected format
              content: message
          });
      }

      function scrollToBottom() {
        var chatContent = document.getElementById('chatContent');
        chatContent.scrollTop = chatContent.scrollHeight;
      }

      async function fetchChatResponse(userMessage) {
          const url = 'https://api.together.xyz/v1/chat/completions';
          //TOGETHER API KEY
          const apiKey = ''; // Replace with your actual API key

          const headers = new Headers({
              'Content-Type': 'application/json',
              'Authorization': `Bearer ${apiKey}`
          });

          // Include chat history in the data object
          const data = {
              model: 'mistralai/Mixtral-8x7B-Instruct-v0.1',
              max_tokens: 1024,
              messages: [...chatHistory, {role: 'user', content: userMessage}],
              "stream_tokens": true
          };

          const options = {
              method: 'POST',
              headers,
              body: JSON.stringify(data)
          };


          const response1 = await fetchEventSource(url, {options,
            onmessage(ev) {
                console.log(ev.data);
            }
          });

          const response = await fetch(url, options);
          const result = await response.json();
          
          // Assuming the API returns a single response message
          return result.choices[0].message.content; // Adjust based on actual API response structure
      }


      document.getElementById('chatInput').addEventListener('keypress', async function(event) {
          if (event.key === 'Enter') {
            event.preventDefault(); // Prevent form submission if your input is in a form

            var message = this.value.trim();
            if (message) {
              displayUserMessage(message);
              console.log("Calling together...")
              try {
                const response = await fetchChatResponse(message);
                displayBotResponse(response);
              } catch (error) {
                console.error('Chat API Error:', error);
                displayBotResponse("Sorry, I can't respond right now.");
              }
              console.log("Called together...")
              this.value = ''; // Clear the input field
            }
          }
        });

    </script> -->


	</body>
</html>